<!--
MkDocs version : 1.6.1
Build Date UTC : 19 February 2026 11:35:22
Last edit: 19 February 2026
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="theme-color" content="#338033">
        <meta name="theme-color" content="#338033" media="(prefers-color-scheme: dark)">
        <meta property="og:image" content="../images/image-facebook.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1080">
        <meta property="og:image:height" content="1080">

        
        
        <link rel="canonical" href="https://sumo.dlr.de/docs/TraCI/Interfacing_TraCI_from_Python.html">
        <link rel="shortcut icon" href="../images/favicon.ico">
        <title>Interfacing TraCI from Python - SUMO Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.all.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-3.7.0.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 

      <script>
        // DARK MODE
        function detectColorScheme(){
          var theme="light";

          if(localStorage.getItem("sumo-docs-theme")){
              if(localStorage.getItem("sumo-docs-theme") == "dark"){
                  var theme = "dark";
              }
          } else if(!window.matchMedia) {
              return false;
          } else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
              var theme = "dark";
          }

          if (theme=="dark") {
              document.documentElement.setAttribute("data-theme", "dark");
          }
        }
        detectColorScheme();
      </script>

    </head>

    <body>

    <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary text-center">
    <div class="container-fluid">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>

        <!-- Expanded navigation -->
        <div id="navbar-collapse" class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="navitem">
                        <a href="../index.html" class="nav-link">Documentation</a>
                    </li>
                    <li class="navitem">
                        <a href="../Tutorials/index.html" class="nav-link">Tutorials</a>
                    </li>
                    <li class="navitem">
                        <a href="../FAQ.html" class="nav-link">FAQ</a>
                    </li>
                    <li class="navitem">
                        <a href="../Downloads.html" class="nav-link">Downloads</a>
                    </li>
                    <li class="navitem">
                        <a href="../Publications.html" class="nav-link">Publications</a>
                    </li>
                    <li class="navitem">
                        <a href="../Developer/index.html" class="nav-link">Developer</a>
                    </li>
                    <li class="navitem">
                        <a href="../ChangeLog.html" class="nav-link">ChangeLog</a>
                    </li>
                    <li class="navitem">
                        <a href="https://eclipse.dev/sumo/contact/" class="nav-link">Contact</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav ml-auto">
                <li class="nav-item">
                    <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa-solid fa-magnifying-glass"></i> <u>S</u>earch
                    </a>
                </li>
                    <li class="nav-item">
                        <a rel="edit" href="https://github.com/eclipse-sumo/sumo/edit/main/docs/web/docs/TraCI/Interfacing_TraCI_from_Python.md" class="nav-link"><i class="fa-brands fa-github"></i> <u>E</u>dit on GitHub</a>
                    </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                    More <i class="fa-solid fa-circle-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item no-arrow-link" href="https://github.com/eclipse/sumo/issues">Report a Bug / Issue / Typo</a>
                    <a class="dropdown-item" href="../Editing_Articles.html">Help on editing articles</a>
                    <a class="dropdown-item" href="https://github.com/eclipse/sumo/commits/main/docs/web">Recent documentation changes</a>
                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#mkdocs_keyboard_modal">Keyboard Shortcuts</a>
                    <a class="dropdown-item no-arrow-link" href="https://sumo.dlr.de/sumo_documentation.zip">Download the Documentation</a>
                    <span class="dropdown-item" id="dark-mode-div">Dark mode <label id="theme-switch" class="theme-switch" for="checkbox_theme">
                        <input type="checkbox" id="checkbox_theme">
                    </label></span>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="languagedrop" data-toggle="dropdown">
                    <i class="fa-solid fa-language"></i> Languages <i class="fa-solid fa-circle-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                    <span class="dropdown-item">
                        Translations are generated automatically by Google Translate:
                    </span>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=de">Deutsch</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=es">Español</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=pt">Português</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=fr">Français</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=it">Italiano</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=zh-CN">简体中文</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=zh-TW">繁體中文</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=tr">Türkçe</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=ja">日本語</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=en&_x_tr_tl=ko">한국어</a>
                    <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/TraCI/Interfacing_TraCI_from_Python.html?_x_tr_sl=auto&_x_tr_tl=en"><i class="fa-solid fa-arrow-right"></i> Other languages</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container-fluid">
          <div class="row">
                <div class="col-md-3">
                  <div class="text-center"><a href="../index.html" style="display: inline-block; margin-top: 5px;"><img src="../images/sumo-logo.png" class="sumoLogo" alt="SUMO Logo" width="120px"></a></div>
                  
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed mb-1" data-toggle="collapse" data-target="#toc-collapse" title="Contents">
            <span class="fa-solid fa-angle-down"></span>
        </button>
    </div>
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary toc-scroll toc">
        <ul class="nav flex-column bs-sidenav">
            <p style="margin-top:5px; color:#777777;" class="text-center">Contents</p>
            <li class="nav-item main"><a href="#importing_traci_in_a_script">importing traci in a script</a></li>
            <li class="nav-item main"><a href="#first_steps">First Steps</a></li>
            <li class="nav-item main"><a href="#subscriptions">Subscriptions</a></li>
            <li class="nav-item main"><a href="#context_subscriptions">Context Subscriptions</a></li>
            <li class="nav-item main"><a href="#context_subscription_filters">Context Subscription Filters</a></li>
            <li class="nav-item main"><a href="#adding_a_steplistener">Adding a StepListener</a></li>
            <li class="nav-item main"><a href="#controlling_parallel_simulations_from_the_same_traci_script">Controlling parallel simulations from the same TraCI script</a></li>
            <li class="nav-item main"><a href="#controlling_the_same_simulation_from_multiple_clients">Controlling the same simulation from multiple clients</a></li>
            <li class="nav-item main"><a href="#concurrent_access_to_the_same_traci_connection">Concurrent access to the same TraCI connection</a></li>
            <li class="nav-item main"><a href="#additional_functions">Additional Functions</a></li>
            <li class="nav-item main"><a href="#pitfalls_and_solutions">Pitfalls and Solutions</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#determine_the_traci_library_being_loaded" class="nav-link">• Determine the traci library being loaded</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#debugging_a_traci_session_on_linux" class="nav-link">• Debugging a TraCI session on Linux</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#generating_a_log_of_all_traci_commands" class="nav-link">• Generating a log of all traci commands</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#determine_why_the_traci_client_cannot_connect" class="nav-link">• Determine why the TraCI client cannot connect</a>
                </li>
            <li class="nav-item main"><a href="#usage_examples">Usage Examples</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#run_a_simulation_until_all_vehicles_have_arrived" class="nav-link">• Run a simulation until all vehicles have arrived</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#add_trips_incomplete_routes_dynamically" class="nav-link">• Add trips (incomplete routes) dynamically</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#coordinate_transformations" class="nav-link">• Coordinate transformations</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#retrieve_the_timeloss_for_all_vehicles_currently_in_the_network" class="nav-link">• Retrieve the timeLoss for all vehicles currently in the network</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#handling_exceptions" class="nav-link">• Handling Exceptions</a>
                </li>
            <li class="nav-item main"><a href="#further_resources">Further Resources</a></li>
        </ul>
    </div>

    <div class="admonition conference" style="position: sticky; margin-top: 20px; margin-bottom:10px;">
        <p>visit <a class="no-arrow-link" href="https://eclipse.dev/sumo">eclipse.dev/sumo</a></p>
    </div>

    <div class="admonition" style="position: sticky; margin-top: 20px; margin-bottom:10px; background-color: #d6cbb2; border-color: #c6b795; padding: 0;">
        <center>
            <a class="no-arrow-link" href="https://eclipse.dev/sumo/conference"><img src="../images/SUMO2026.png" alt="SUMO User Conference 2025" class="img-fluid" style="max-height: 200px"></a>
        </center>
    </div>

</div>
                </div>
                <div class="col-md-9 main-area" role="main">
                   <!-- page.is_homepage seems to be broken in Mkdocs > 1.1.0 -->
                  <ul class="breadcrumbs">
    <script>
        var pagePath = "/docs/TraCI/Interfacing_TraCI_from_Python.html";
        var splitUrl = pagePath.split("/");
        splitUrl.pop();
        splitUrl.shift();
        if (splitUrl[0] == 'docs') splitUrl.shift();
        var homeLink = "../index.html";
        document.write('<li class="breadcrumb-item"><a href="' + homeLink + '"><i class="fa-solid fa-house"></i></a></li>');
        var prev = '';

        var dirLink = splitUrl.map(function (el) {
        el = prev + el; prev = el + '/'; return el;
        });

        for (let i = 0; i < splitUrl.length; i++) {
            document.write("<li class=\"breadcrumb-item\"><a class=\"no-arrow-link\" href=\"../" + dirLink[i] + "\">" + splitUrl[i] + "</a></li>");
        }
    </script>
    <li class="breadcrumb-item active">Interfacing TraCI from Python</li>
</ul>
                  <hTitles>Interfacing TraCI from Python<hr style="border: 0.5px solid #338033; margin-top: 5px !important;"></hTitles>
                  
                  

<p>The <a href="index.html#traci_commands">TraCI</a> commands are split into the
domains busstop, calibrator, chargingstation, edge, gui, inductionloop, junction, lane,
lanearea, meandata, multientryexit, overheadwire, parkingarea, person, poi, polygon,
rerouter, route, routeprobe, simulation, trafficlight, variablespeedsign, vehicle, and vehicletype,
vehicle, which correspond to individual modules. For a detailed list of
available functions see the <a href="https://sumo.dlr.de/pydoc/traci.html">pydoc generated documentation</a>. The source code
can be found at
<a href="https://github.com/eclipse-sumo/sumo/tree/main/tools/traci">[1]</a>.</p>
<p>Please note that if performance is an issue and you don't a need GUI, it is almost always better
to use <a href="../Libsumo.html">libsumo</a> instead of traci, which has the same API.</p>
<h2 id="importing_traci_in_a_script">importing <strong>traci</strong> in a script<a class="headerlink" href="#importing_traci_in_a_script" title="Permanent link">#</a></h2>
<p>To use the library, you can install it using <code>pip install traci</code> or add the <strong><em>&lt;SUMO_HOME&gt;</em></strong>/tools directory
to your Python load path. This is typically done with a stanza like this:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="s1">&#39;SUMO_HOME&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SUMO_HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;tools&#39;</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">traci</span>
</code></pre></div>

<p>This assumes that the <a href="../Basics/Basic_Computer_Skills.html#sumo_home">environment variable
<strong>SUMO_HOME</strong></a>
is set before running the script. Alternatively, you can declare the
path to <em>sumo/tools</em> directly as in the line</p>
<div class="codehilite"><pre><span></span><code><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;c:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;whatever&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="s1">&#39;sumo&#39;</span><span class="p">,</span> <span class="s1">&#39;tools&#39;</span><span class="p">))</span>
</code></pre></div>

<p>If you decide to switch to libsumo at a later stage or want to be flexible here,
you can replace the import line later by:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">libsumo</span> <span class="k">as</span> <span class="nn">traci</span>
</code></pre></div>

<h2 id="first_steps">First Steps<a class="headerlink" href="#first_steps" title="Permanent link">#</a></h2>
<p>In general it is very easy to interface with SUMO from Python (the
following example is a modification of
<a href="../Tutorials/TraCI4Traffic_Lights.html">tutorial/traci_tls</a>):</p>
<p>First you compose the command line to start either
<a href="../sumo.html">sumo</a> or <a href="../sumo-gui.html">sumo-gui</a> (leaving out
the option  which was needed before 0.28.0):</p>
<div class="codehilite"><pre><span></span><code><span class="n">sumoBinary</span> <span class="o">=</span> <span class="s2">&quot;/path/to/sumo-gui&quot;</span>
<span class="n">sumoCmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">sumoBinary</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;yourConfiguration.sumocfg&quot;</span><span class="p">]</span>
</code></pre></div>

<p>Then you start the simulation and connect to it with your script:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">traci</span>
<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">sumoCmd</span><span class="p">)</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">traci</span><span class="o">.</span><span class="n">inductionloop</span><span class="o">.</span><span class="n">getLastStepVehicleNumber</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">traci</span><span class="o">.</span><span class="n">trafficlight</span><span class="o">.</span><span class="n">setRedYellowGreenState</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;GrGr&quot;</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>After connecting to the simulation, you can emit various commands and
execute simulation steps until you want to finish by closing the
connection. By default, the close command will wait until the sumo
process really finishes. You can disable this by calling:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<h2 id="subscriptions">Subscriptions<a class="headerlink" href="#subscriptions" title="Permanent link">#</a></h2>
<p>Subscriptions can be thought of as a batch mode for retrieving
variables. Instead of asking for the same variables over and over again,
you can retrieve the values of interest automatically after each time
step. TraCI subscriptions are handled on a per module basis. That is you
can ask the module for the result of all current subscriptions after
each time step. In order to subscribe for variables you need to know
their variable ids which can be looked up in the traci/constants.py
file.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">traci</span>
<span class="kn">import</span> <span class="nn">traci.constants</span> <span class="k">as</span> <span class="nn">tc</span>

<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;my.sumocfg&quot;</span><span class="p">])</span>
<span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">vehID</span><span class="p">,</span> <span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_ROAD_ID</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">VAR_LANEPOSITION</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">getSubscriptionResults</span><span class="p">(</span><span class="n">vehID</span><span class="p">))</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">getSubscriptionResults</span><span class="p">(</span><span class="n">vehID</span><span class="p">))</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>The values retrieved are always the ones from the last time step, it is
not possible to retrieve older values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before version 1.18.0 <code>traci.simulationStep()</code> returned all subscription results, now it returns None.
If you need the old behavior, use <code>traci.simulationStepLegacy()</code>.</p>
</div>
<h2 id="context_subscriptions">Context Subscriptions<a class="headerlink" href="#context_subscriptions" title="Permanent link">#</a></h2>
<p>Context subscriptions work like subscriptions in that they retrieve a
list of variables automatically for every simulation stop. However, the
do so by setting a reference object and a range and then retrieving
variables for all objects of a given type within range of the reference
object.</p>
<p>TraCI context subscriptions are handled on a per module basis. That is
you can ask the module for the result of all current subscriptions after
each time step. In order to subscribe for variables you need to the
domain id of the objects that shall be retrieved and the variable ids
which can be looked up in the traci/constants.py file. The domain id
always has the form CMD_GET_&lt;DOMAIN&gt;_VARIABLE. The following code
retrieves all vehicle speeds and waiting times within range (42m) of a
junction (the vehicle ids are retrieved implicitly).</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">traci</span>
<span class="kn">import</span> <span class="nn">traci.constants</span> <span class="k">as</span> <span class="nn">tc</span>

<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;my.sumocfg&quot;</span><span class="p">])</span>
<span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">subscribeContext</span><span class="p">(</span><span class="n">junctionID</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">CMD_GET_VEHICLE_VARIABLE</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_SPEED</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">VAR_WAITING_TIME</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">getContextSubscriptionResults</span><span class="p">(</span><span class="n">junctionID</span><span class="p">))</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">getContextSubscriptionResults</span><span class="p">(</span><span class="n">junctionID</span><span class="p">))</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>The values retrieved are always the ones from the last time step, it is
not possible to retrieve older values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before version 1.18.0 <code>traci.junction.getAllContextSubscriptionResults</code> would not contain
the ids of the junctions which did not have objects in their context.
Now it returns their id mapped to an empty dictionary (similar to libsumo). This holds for the other domains as well.</p>
</div>
<h2 id="context_subscription_filters">Context Subscription Filters<a class="headerlink" href="#context_subscription_filters" title="Permanent link">#</a></h2>
<p>For vehicle-to-vehicle context subscriptions (i.e., context
subscriptions, whose reference object is a vehicle and whose requested
context objects are vehicles as well) it is possible to request
additional filters to be applied already on the server side. The general
procedure is to equip a requested context subscription with the filter
directly after the call to <code>subscribeContext()</code> by a successive call to
<code>addSubscriptionFilter&lt;FILTER_ID&gt;()</code> as for instance in the following
snippet:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">subscribeContext</span><span class="p">(</span><span class="s2">&quot;ego&quot;</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">CMD_GET_VEHICLE_VARIABLE</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_SPEED</span><span class="p">])</span>
<span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">addSubscriptionFilterLanes</span><span class="p">(</span><span class="n">lanes</span><span class="p">,</span> <span class="n">noOpposite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">downstreamDist</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">upstreamDist</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div>

<p>The first line requests a context subscription for the speed of vehicles
in the neighborhood of the reference vehicle with the ID <code>"ego"</code>. The
range of the context subscription (which refers to the radial context
region of the usual subscription mechanism) can be set equal to <code>0.0</code>,
since it is be overridden by the selective values of <code>downstreamDist</code>
and <code>upstreamDist</code>, respectively, given to the call of
<code>addSubscriptionFilterLanes()</code> in the second line. The call to
<code>addSubscriptionFilter&lt;FILTER_NAME&gt;()</code> automatically takes effect on
the last issued context subscription, which has to be of the
vehicle-to-vehicle form for a successful application.</p>
<p>The following filter types are available:</p>
<ul>
<li>Lanes: Return surrounding vehicles on lanes specified relatively to
  the reference vehicle</li>
<li>CFManeuver: Return leader and follower on the reference vehicle's
  lane</li>
<li>LCManeuver: Return leader and follower on the reference vehicle's
  lane and neighboring lane(s)</li>
<li>Turn: Return conflicting vehicles on upcoming junctions along the
  vehicle's route</li>
<li>VType: Only return vehicles of the specified vTypes</li>
<li>VClass: Only return vehicles of the specified vClasses</li>
</ul>
<p>See the <a href="https://sumo.dlr.de/pydoc/traci._vehicle.html#VehicleDomain-addSubscriptionFilterCFManeuver">pydoc
documentation</a>
for detailed specifications.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The filter only takes effect in subsequent simulation steps. The vehicle values returned directly after issuing the subscription are not affected.</p>
</div>
<h2 id="adding_a_steplistener">Adding a StepListener<a class="headerlink" href="#adding_a_steplistener" title="Permanent link">#</a></h2>
<p>Often a function needs to be called each time when
traci.simulationStep() is called, to let this happen automatically
(always <em>after</em> each call to simulationStep()) it is possible to add a
StepListener object 'listener' (more precisely an instance of a subclass
of traci.StepListener) i.e.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ExampleListener</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">StepListener</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="c1"># do something after every call to simulationStep</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ExampleListener called with parameter </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
        <span class="c1"># indicate that the step listener should stay active in the next step</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">listener</span> <span class="o">=</span> <span class="n">ExampleListener</span><span class="p">()</span>
<span class="n">traci</span><span class="o">.</span><span class="n">addStepListener</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
</code></pre></div>

<p>Please note that the listener is not activated for every simulation step
but for every call to simulationStep (which may perform multiple steps up to the given time <em>t</em>).
Furthermore the parameter <em>t</em> is not the current simulation time but exactly
the (optional) parameter passed to the simulationStep call (which is 0 by default).</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>A TraCI StepListener cannot be used in the case that one TraCI client controls several SUMO-instances.</p>
</div>
<h2 id="controlling_parallel_simulations_from_the_same_traci_script">Controlling parallel simulations from the same TraCI script<a class="headerlink" href="#controlling_parallel_simulations_from_the_same_traci_script" title="Permanent link">#</a></h2>
<p>The TraCI python library can be used to control multiple simulations at
the same time with a single script. The function <em>traci.start()</em> has an
optional label argument which allows you to call it multiple times with
different simulation instances and labels. The function <em>traci.switch()</em>
can then be used to switch to any of the initialized labels:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;sim1.sumocfg&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sim1&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;sim2.sumocfg&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sim2&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;sim1&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span> <span class="c1"># run 1 step for sim1</span>
<span class="n">traci</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;sim2&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span> <span class="c1"># run 1 step for sim2</span>
<span class="n">traci</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;sim1&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">traci</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;sim2&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>If you prefer a more object oriented approach you can also use
connection objects to communicate with the simulation. They have the
same interface as the static <em>traci.</em> calls but you will still need to
start the simulation manually for them:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;sim1.sumocfg&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sim1&quot;</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;sim2.sumocfg&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sim2&quot;</span><span class="p">)</span>
<span class="n">conn1</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">getConnection</span><span class="p">(</span><span class="s2">&quot;sim1&quot;</span><span class="p">)</span>
<span class="n">conn2</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">getConnection</span><span class="p">(</span><span class="s2">&quot;sim2&quot;</span><span class="p">)</span>
<span class="n">conn1</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span> <span class="c1"># run 1 step for sim1</span>
<span class="n">conn2</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span> <span class="c1"># run 1 step for sim2</span>
</code></pre></div>

<h2 id="controlling_the_same_simulation_from_multiple_clients">Controlling the same simulation from multiple clients<a class="headerlink" href="#controlling_the_same_simulation_from_multiple_clients" title="Permanent link">#</a></h2>
<p>To connect with multiple clients, the number of clients must be known in
advance and specified with sumo option <strong>--num-clients</strong> <a href="/docs/Basics/Notation.html#referenced_data_types"><em>&lt;INT&gt;</em></a>. Also, the connection port must
be known to all clients. After deciding on a port it can be made
available to the clients via arguments or configuration files. A free
port can be obtained by</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">sumolib.miscutils</span> <span class="kn">import</span> <span class="n">getFreeSocketPort</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">sumolib</span><span class="o">.</span><span class="n">miscutils</span><span class="o">.</span><span class="n">getFreeSocketPort</span><span class="p">()</span>
</code></pre></div>

<p>One client may use method <em>traci.start()</em> to start the simulation and
connect to it at the same time while the other client only needs to
connect. After establishing client order, each client must continuously
call <em>simulationStep</em> to allow the simulation to advance:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#client1</span>
<span class="c1"># PORT = int(sys.argv[1]) # example</span>
<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;sim.sumocfg&quot;</span><span class="p">,</span> <span class="s2">&quot;--num-clients&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># number can be anything</span>
<span class="k">while</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getMinExpectedNumber</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="c1"># more traci commands</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1"># client2</span>
<span class="c1"># PORT = int(sys.argv[1]) # example</span>
<span class="n">traci</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PORT</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># number can be anything as long as each client gets its own number</span>
<span class="k">while</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getMinExpectedNumber</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="c1"># more traci commands</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h2 id="concurrent_access_to_the_same_traci_connection">Concurrent access to the same TraCI connection<a class="headerlink" href="#concurrent_access_to_the_same_traci_connection" title="Permanent link">#</a></h2>
<p>Before SUMO 1.17.0 the pure Python client as well as the libtraci implementation
will probably crash if you try to access the same connection from different
threads.</p>
<p>Currently there are some measures implemented which at least prevent the direct
conflicts when accessing the socket. It is however still encouraged to use the
multi-client approach from the previous section. It is the only way to ensure
that commands are sent in the expected order. If there is only one thread issuing
the simulationStep command and the others only query
the simulation also multi threaded access should work.</p>
<h2 id="additional_functions">Additional Functions<a class="headerlink" href="#additional_functions" title="Permanent link">#</a></h2>
<p>When using TraCI there are some common tasks which are not covered by
the traci library such as</p>
<ul>
<li>Analyzing the road network</li>
<li>Parsing simulation outputs</li>
</ul>
<p>For this functionality it is recommended to use
<a href="../Tools/Sumolib.html">Tools/Sumolib</a></p>
<h2 id="pitfalls_and_solutions">Pitfalls and Solutions<a class="headerlink" href="#pitfalls_and_solutions" title="Permanent link">#</a></h2>
<ul>
<li>Note that strings, if exchanged, had to be plain ASCII before 1.18.0.
  Currently UTF-8 should be possible for all the strings.</li>
<li>If you start sumo from within your python script using
  subprocess.Popen, be sure to call wait() on the resulting process
  object before quitting your script. You might loose output
  otherwise.</li>
</ul>
<h3 id="determine_the_traci_library_being_loaded">Determine the traci library being loaded<a class="headerlink" href="#determine_the_traci_library_being_loaded" title="Permanent link">#</a></h3>
<p>When working with different sumo versions it may happen that the call <code>import traci</code> loads the wrong library.
The easiest way to debug this is to add the following lines after the import</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">traci</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LOADPATH:&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRACIPATH:&quot;</span><span class="p">,</span> <span class="n">traci</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</code></pre></div>

<p>Make sure that the TRACIPATH corresponds to the sumo version that you wish to use.
If it does not, then the order of directories in LOADPATH (sys.path) must be changed
or the SUMO installation must be removed from any directories that come before the wanted directory.</p>
<h3 id="debugging_a_traci_session_on_linux">Debugging a TraCI session on Linux<a class="headerlink" href="#debugging_a_traci_session_on_linux" title="Permanent link">#</a></h3>
<p>Sometimes SUMO may crash while running a simulation with TraCI. The
below steps make it simple to run sumo with traci in a debugger:</p>
<p>1) Add the option <em>--save-configuration</em> to your traci script:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="n">sumoBinary</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;run.sumocfg&#39;</span><span class="p">,</span> <span class="s1">&#39;--save-configuration&#39;</span><span class="p">,</span> <span class="s1">&#39;debug.sumocfg&#39;</span><span class="p">])</span>
</code></pre></div>

<p>2) Run your traci script. Instead of starting sumo it will just write
the configuration with the chosen port but it will still try to connect
repeatedly.</p>
<p>3) Run</p>
<div class="codehilite"><pre><span></span><code>gdb --args sumoD -c debug.sumocfg
</code></pre></div>

<p>(where sumoD is sumo <a href="../Installing/Linux_Build.html#building_the_sumo_binaries_with_cmake">compiled in debug
mode</a>)</p>
<h3 id="generating_a_log_of_all_traci_commands">Generating a log of all traci commands<a class="headerlink" href="#generating_a_log_of_all_traci_commands" title="Permanent link">#</a></h3>
<p>To share a traci scenario (i.e. in a bug report) it may be useful to separate the logic of the traci script from the actual commands.
For this, the function <code>traci.start</code> accepts the optional arguments <code>traceFile</code> and <code>traceGetters</code>.
When calling <code>traci.start([&lt;commands&gt;], traceFile=&lt;LOG_FILE_PATH&gt;)</code> all traci commands that were sent to sumo will be written to the given LOG_FILE_PATH.
This allows re-running the scenario without the original runner script.</p>
<p>When option <code>traceGetters=False</code> is set, only functions that change the simulation state are included in the log file. Functions that retrieve simulation data are technically not needed to reproduce a scenario but it may be useful to include them if the data retrieval functions are themselves the cause of a bug.</p>
<p>When option <code>traceGetters="print"</code> is set, all getter functions will print themselves and their results to standard output when running the log as a python program.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Avoid running the simulation with option <strong>--random</strong> since this will most likely prevent your traceFile from being repeated</p>
</div>
<h3 id="determine_why_the_traci_client_cannot_connect">Determine why the TraCI client cannot connect<a class="headerlink" href="#determine_why_the_traci_client_cannot_connect" title="Permanent link">#</a></h3>
<p>Possibly, the arguments given to <code>traci.start</code> generated an error when launching SUMO. This will manifest as</p>
<p><code>traci.exceptions.FatalTraCIError: Could not connect.</code></p>
<p>To diagnose the problem, add options for writing a log file <code>traci.start</code> (i.e. <code>traci.start(['sumo', '-c', 'example.sumocfg', '--log', 'logfile.txt'])</code>)
After the script fails to start, look into the written logfile and fix the error reported therein.</p>
<h2 id="usage_examples">Usage Examples<a class="headerlink" href="#usage_examples" title="Permanent link">#</a></h2>
<h3 id="run_a_simulation_until_all_vehicles_have_arrived">Run a simulation until all vehicles have arrived<a class="headerlink" href="#run_a_simulation_until_all_vehicles_have_arrived" title="Permanent link">#</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">while</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getMinExpectedNumber</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
</code></pre></div>

<h3 id="add_trips_incomplete_routes_dynamically">Add trips (incomplete routes) dynamically<a class="headerlink" href="#add_trips_incomplete_routes_dynamically" title="Permanent link">#</a></h3>
<p>Define a route that consists of the start and destination edge:</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">route</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;trip&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;startEdge&quot;</span><span class="p">,</span> <span class="s2">&quot;endEdge&quot;</span><span class="p">])</span>
</code></pre></div>

<p>Then add the vehicle with that route</p>
<div class="codehilite"><pre><span></span><code><span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;newVeh&quot;</span><span class="p">,</span> <span class="s2">&quot;trip&quot;</span><span class="p">,</span> <span class="n">typeID</span><span class="o">=</span><span class="s2">&quot;reroutingType&quot;</span><span class="p">)</span>
</code></pre></div>

<p>This will cause the vehicle to compute a new route from startEdge to
endEdge according to the estimated travel times in the network at the
time of departure. For details of this mechanism see
<a href="../Demand/Automatic_Routing.html">Demand/Automatic_Routing</a>.</p>
<h3 id="coordinate_transformations">Coordinate transformations<a class="headerlink" href="#coordinate_transformations" title="Permanent link">#</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">vehID</span><span class="p">)</span>
<span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">convertGeo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">convertGeo</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">fromGeo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">edgeID</span><span class="p">,</span> <span class="n">lanePosition</span><span class="p">,</span> <span class="n">laneIndex</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">convertRoad</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
<span class="n">edgeID</span><span class="p">,</span> <span class="n">lanePosition</span><span class="p">,</span> <span class="n">laneIndex</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">convertRoad</span><span class="p">(</span><span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="retrieve_the_timeloss_for_all_vehicles_currently_in_the_network">Retrieve the timeLoss for all vehicles currently in the network<a class="headerlink" href="#retrieve_the_timeloss_for_all_vehicles_currently_in_the_network" title="Permanent link">#</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">traci</span>
<span class="kn">import</span> <span class="nn">traci.constants</span> <span class="k">as</span> <span class="nn">tc</span>
<span class="n">traci</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="s2">&quot;sumo&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;my.sumocfg&quot;</span><span class="p">])</span>
<span class="c1"># pick an arbitrary junction</span>
<span class="n">junctionID</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">getIDList</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># subscribe around that junction with a sufficiently large</span>
<span class="c1"># radius to retrieve the speeds of all vehicles in every step</span>
<span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">subscribeContext</span><span class="p">(</span>
    <span class="n">junctionID</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">CMD_GET_VEHICLE_VARIABLE</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">,</span>
    <span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_SPEED</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">VAR_ALLOWED_SPEED</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">stepLength</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getDeltaT</span><span class="p">()</span>
<span class="k">while</span> <span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getMinExpectedNumber</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">traci</span><span class="o">.</span><span class="n">simulationStep</span><span class="p">()</span>
    <span class="n">scResults</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">getContextSubscriptionResults</span><span class="p">(</span><span class="n">junctionID</span><span class="p">)</span>
    <span class="n">halting</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">scResults</span><span class="p">:</span>
        <span class="n">relSpeeds</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_SPEED</span><span class="p">]</span> <span class="o">/</span> <span class="n">d</span><span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_ALLOWED_SPEED</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">scResults</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="c1"># compute values corresponding to summary-output</span>
        <span class="n">running</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">relSpeeds</span><span class="p">)</span>
        <span class="n">halting</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">scResults</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">tc</span><span class="o">.</span><span class="n">VAR_SPEED</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="n">meanSpeedRelative</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">relSpeeds</span><span class="p">)</span> <span class="o">/</span> <span class="n">running</span>
        <span class="n">timeLoss</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">meanSpeedRelative</span><span class="p">)</span> <span class="o">*</span> <span class="n">running</span> <span class="o">*</span> <span class="n">stepLength</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">traci</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">getTime</span><span class="p">(),</span> <span class="n">timeLoss</span><span class="p">,</span> <span class="n">halting</span><span class="p">)</span>
<span class="n">traci</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="handling_exceptions">Handling Exceptions<a class="headerlink" href="#handling_exceptions" title="Permanent link">#</a></h3>
<p>Sometimes commands raise an (recoverable) exception to indicate an error (unknown id, route not found etc.). These exceptions
can be handled by your code as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="p">:</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">traci</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">vehID</span><span class="p">)</span>
<span class="k">except</span> <span class="n">traci</span><span class="o">.</span><span class="n">TraCIException</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c1"># or do something smarter</span>
</code></pre></div>

<h2 id="further_resources">Further Resources<a class="headerlink" href="#further_resources" title="Permanent link">#</a></h2>
<ul>
<li>The module <a href="../Simpla.html">Simpla</a> provides a library for
  platooning functions that can be integrated with user client
  scripts.</li>
</ul>
                </div>
          </div>
          <button onclick="goTopFunction()" id="goToTop" title="Go to top"><i class="fa-solid fa-arrow-up"></i></button>
        </div>

        <footer class="col-md-12">
          
            <br><small><i>This page was last edited on: 19 February 2026</i></small>
          
          <hr>
            <p>Copyright &copy; 2001-2026 German Aerospace Center (DLR) and others.</p>
          <p>Follow us on <a class="no-arrow-link" href="https://www.twitter.com/eclipsesumo/"><i class="fa-brands fa-x-twitter"></i></a> <a class="no-arrow-link" href="https://www.facebook.com/simulationofurbanmobility/"><i class="fa-brands fa-facebook"></i></a> <a class="no-arrow-link" href="https://www.instagram.com/eclipse.sumo/"><i class="fa-brands fa-instagram"></i></a> <a class="no-arrow-link" href="https://www.threads.net/@eclipse.sumo"><i class="fa-brands fa-threads"></i></a> <a class="no-arrow-link" href="https://bsky.app/profile/eclipse-sumo.bsky.social"><i class="fa-brands fa-bluesky"></i></a> <a class="no-arrow-link" href="https://www.linkedin.com/groups/5156801/"><i class="fab fa-linkedin"></i></a>
          | Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a></p>
        </footer>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body" style="color: #495057 !important;">
                <p>Enter your search terms:</p>
                <script async src="https://cse.google.com/cse.js?cx=004302551366764109984:1kpgtzrm6kv"></script>
                <div class="gcse-search"></div>
            </div>
        </div>
    </div>
</div>
      <script>
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("goToTop").style.display = "block";
          } else {
            document.getElementById("goToTop").style.display = "none";
          }
        }

        function goTopFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        var base_url = "..",
            shortcuts = {"edit": 69, "help": 191, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>

        <script>
          const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');

          function switchTheme(e) {
              if (e.target.checked) {
                  localStorage.setItem('sumo-docs-theme', 'dark');
                  document.documentElement.setAttribute('data-theme', 'dark');
                  toggleSwitch.checked = true;
              } else {
                  localStorage.setItem('sumo-docs-theme', 'light');
                  document.documentElement.setAttribute('data-theme', 'light');
                  toggleSwitch.checked = false;
              }
          }

          toggleSwitch.addEventListener('change', switchTheme, false);

          if (document.documentElement.getAttribute("data-theme") == "dark"){
              toggleSwitch.checked = true;
          }
          </script>

      <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Key</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody style="color: #495057 !important;">
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help dialog</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search the Documentation</td>
                  </tr>
                  <tr>
                    <td class="edit shortcut"><kbd>e</kbd></td>
                    <td>Edit current page on GitHub</td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>
</div>
    </body>
</html>